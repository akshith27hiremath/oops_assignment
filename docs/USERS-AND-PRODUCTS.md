# LiveMart Users and Products Directory

**Generated**: November 11, 2025
**Database**: livemart_dev

---

## üë• Users Directory

### Total Users: 18
- **Customers**: 8
- **Retailers**: 7
- **Wholesalers**: 3

---

## üõí CUSTOMERS (8)

### Active Production Customers

| Email | Name | Location | Auth Provider | Created |
|-------|------|----------|---------------|---------|
| `amazingaky123@gmail.com` | Akshith | ‚úÖ [78.3772, 17.4435] | local | Oct 21, 2025 |
| `f20242001@hyderabad.bits-pilani.ac.in` | Akshith Hiremath | ‚úÖ [78.3769927, 17.4335962] | local | Oct 31, 2025 |

### Test/Inactive Customers (Recommended for Deletion)

| Email | Name | Location | Auth Provider | Created | Notes |
|-------|------|----------|---------------|---------|-------|
| `customer@test.com` | Updated Customer Name | ‚ùå No location | local | Oct 21, 2025 | Has 1 order (kept) |
| `akshith.hiremath@gmail.com` | Akshith Hiremath | ‚ùå No location | local | Oct 21, 2025 | No activity |
| `frankathon@gmail.com` | Frank Athon | ‚ùå No location | local | Oct 22, 2025 | No activity |
| `jimjameater123@gmail.com` | Mr Jim | ‚ùå No location | local | Oct 30, 2025 | No activity |
| `bitsstudent@gmail.com` | Bitsian | ‚ùå No location | local | Oct 30, 2025 | No activity |
| `test@gmail.com` | Ilivein Prasads | ‚ùå No location | local | Oct 30, 2025 | No activity |

---

## üè™ RETAILERS (7)

All retailers have **complete data** with location and GSTIN ‚úÖ

| Email | Business Name | GSTIN | Location | Created | Products |
|-------|--------------|-------|----------|---------|----------|
| `moremegastore@gmail.com` | N/A | 27ADCBE1234F2Z5 | ‚úÖ [78.4482, 17.4126] | Oct 22, 2025 | 2 |
| `buymycarrots@gmail.com` | N/A | 27UXYED1234F1Z5 | ‚úÖ [78.39, 17.45] | Oct 30, 2025 | 0 |
| `freshveggies@hyderabad.com` | Fresh Veggies Store | 36AAAAA1111A1Z5 | ‚úÖ [78.3584, 17.4399] | Oct 30, 2025 | 6 |
| `fruitparadise@hyderabad.com` | Fruit Paradise | 36BBBBB2222B2Z5 | ‚úÖ [78.4897, 17.4239] | Oct 30, 2025 | 6 |
| `organicbazaar@hyderabad.com` | Organic Bazaar | 36CCCCC3333C3Z5 | ‚úÖ [78.343, 17.4944] | Oct 30, 2025 | 6 |
| `spicemarket@hyderabad.com` | Spice Market | 36DDDDD4444D4Z5 | ‚úÖ [78.4563, 17.385] | Oct 30, 2025 | 6 |
| `dairydelights@hyderabad.com` | Dairy Delights | 36EEEEE5555E5Z5 | ‚úÖ [78.399, 17.465] | Oct 30, 2025 | 6 |

---

## üè≠ WHOLESALERS (3)

| Email | Business Name | GSTIN | Location | Created | Products | B2B Orders |
|-------|--------------|-------|----------|---------|----------|-----------|
| `wholesaler@test.com` | Wholesale Supplies Inc | 27ABCDE5678K1Z5 | ‚ùå No location | Oct 21, 2025 | 0 | 0 |
| `wholesaler2@test.com` | Premium Wholesale Hub | 22CCCCC0000C1Z5 | ‚ö†Ô∏è **No location** | Oct 25, 2025 | 1 | **2 active** |
| `wholesalertest@gmail.com` | Test Wholesale Business | 29ABCDE1234F1Z5 | ‚ö†Ô∏è **No location** | Nov 10, 2025 | 0 | 0 |

### ‚ö†Ô∏è Issues:
- `wholesaler2@test.com` - **ACTIVE** wholesaler with 2 completed B2B orders, but missing location data
- `wholesalertest@gmail.com` - Recent creation, missing location data
- `wholesaler@test.com` - Inactive test account, no products or orders

---

## üì¶ Products Catalog

### Total Products: 33

---

### ü•ï Fresh Veggies Store (6 products)
**Owner**: `freshveggies@hyderabad.com`

| Product | Category | Subcategory | Price | Unit | Created |
|---------|----------|-------------|-------|------|---------|
| Cauliflower | Vegetables | Fresh Vegetables | ‚Çπ45 | piece | Oct 30, 2025 |
| Fresh Carrots | Vegetables | Root Vegetables | ‚Çπ35 | kg | Oct 30, 2025 |
| Fresh Tomatoes | Vegetables | Fresh Vegetables | ‚Çπ40 | kg | Oct 30, 2025 |
| Green Beans | Vegetables | Fresh Vegetables | ‚Çπ60 | kg | Oct 30, 2025 |
| Green Spinach | Vegetables | Leafy Greens | ‚Çπ25 | bunch | Oct 30, 2025 |
| Organic Potatoes | Vegetables | Root Vegetables | ‚Çπ30 | kg | Oct 30, 2025 |

---

### üçé Fruit Paradise (6 products)
**Owner**: `fruitparadise@hyderabad.com`

| Product | Category | Subcategory | Price | Unit | Created |
|---------|----------|-------------|-------|------|---------|
| Fresh Apples | Fruits | Fresh Fruits | ‚Çπ150 | kg | Oct 30, 2025 |
| Fresh Oranges | Fruits | Citrus Fruits | ‚Çπ80 | kg | Oct 30, 2025 |
| Green Grapes | Fruits | Fresh Fruits | ‚Çπ120 | kg | Oct 30, 2025 |
| Ripe Bananas | Fruits | Fresh Fruits | ‚Çπ50 | dozen | Oct 30, 2025 |
| Sweet Mangoes | Fruits | Fresh Fruits | ‚Çπ200 | kg | Oct 30, 2025 |
| Watermelon | Fruits | Fresh Fruits | ‚Çπ30 | kg | Oct 30, 2025 |

---

### üåø Organic Bazaar (6 products)
**Owner**: `organicbazaar@hyderabad.com`

| Product | Category | Subcategory | Price | Unit | Created |
|---------|----------|-------------|-------|------|---------|
| Organic Apples | Fruits | Organic Fruits | ‚Çπ180 | kg | Oct 30, 2025 |
| Organic Brown Rice | Grains | Organic Grains | ‚Çπ90 | kg | Oct 30, 2025 |
| Organic Honey | Organic Products | Sweeteners | ‚Çπ450 | kg | Oct 30, 2025 |
| Organic Jaggery | Organic Products | Sweeteners | ‚Çπ120 | kg | Oct 30, 2025 |
| Organic Tomatoes | Vegetables | Organic Vegetables | ‚Çπ60 | kg | Oct 30, 2025 |
| Organic Turmeric Powder | Spices | Organic Spices | ‚Çπ350 | kg | Oct 30, 2025 |

---

### üå∂Ô∏è Spice Market (6 products)
**Owner**: `spicemarket@hyderabad.com`

| Product | Category | Subcategory | Price | Unit | Created |
|---------|----------|-------------|-------|------|---------|
| Almonds | Dry Fruits | Nuts | ‚Çπ650 | kg | Oct 30, 2025 |
| Black Pepper | Spices | Whole Spices | ‚Çπ550 | kg | Oct 30, 2025 |
| Cashew Nuts | Dry Fruits | Nuts | ‚Çπ700 | kg | Oct 30, 2025 |
| Coriander Powder | Spices | Powdered Spices | ‚Çπ200 | kg | Oct 30, 2025 |
| Garam Masala | Spices | Masala Blends | ‚Çπ400 | kg | Oct 30, 2025 |
| Red Chili Powder | Spices | Powdered Spices | ‚Çπ280 | kg | Oct 30, 2025 |

---

### ü•õ Dairy Delights (6 products)
**Owner**: `dairydelights@hyderabad.com`

| Product | Category | Subcategory | Price | Unit | Created |
|---------|----------|-------------|-------|------|---------|
| Butter | Dairy | Butter | ‚Çπ450 | kg | Oct 30, 2025 |
| Cheese Slices | Dairy | Cheese | ‚Çπ400 | kg | Oct 30, 2025 |
| Fresh Milk | Dairy | Milk Products | ‚Çπ60 | liter | Oct 30, 2025 |
| Ghee | Dairy | Ghee | ‚Çπ550 | kg | Oct 30, 2025 |
| Paneer | Dairy | Cheese | ‚Çπ300 | kg | Oct 30, 2025 |
| Yogurt | Dairy | Milk Products | ‚Çπ50 | kg | Oct 30, 2025 |

---

### üè™ More Megastore (2 products)
**Owner**: `moremegastore@gmail.com`

| Product | Category | Subcategory | Price | Unit | Created |
|---------|----------|-------------|-------|------|---------|
| Jim Jams | Fruits | N/A | ‚Çπ20 | piece | Oct 23, 2025 |
| Red Apples | Fruits | N/A | ‚Çπ70 | kg | Oct 30, 2025 |

---

### üè≠ Premium Wholesale Hub (1 product)
**Owner**: `wholesaler2@test.com` (WHOLESALER)

| Product | Category | Subcategory | Price | Unit | Created |
|---------|----------|-------------|-------|------|---------|
| Apple | Fruits | N/A | ‚Çπ75 | kg | Oct 25, 2025 |

**Note**: This is the only wholesaler with products. Used in B2B orders to retailers.

---

## üìä Product Statistics by Category

| Category | Count | Average Price |
|----------|-------|---------------|
| Dairy | 6 | ‚Çπ302/kg |
| Vegetables | 7 | ‚Çπ42/kg |
| Fruits | 11 | ‚Çπ108/kg |
| Spices | 4 | ‚Çπ358/kg |
| Dry Fruits | 2 | ‚Çπ675/kg |
| Organic Products | 2 | ‚Çπ285/kg |
| Grains | 1 | ‚Çπ90/kg |

---

## üîê OAuth Registration Behavior

### Question: What happens if a user registers with OAuth and then tries to register another account with the same email?

### Answer:

The system handles this **intelligently** based on the code in `server/src/services/oauth.service.ts`:

#### Scenario 1: OAuth Login with Existing Account
**Lines 54-73 (Google) and 122-140 (Facebook)**

```typescript
// Check if user already exists
let user = await User.findOne({
  $or: [
    { 'oauth.google.id': profile.id },
    { email: profile.emails?.[0]?.value },
  ],
});

if (user) {
  // Update Google OAuth data if not set
  if (!user.oauth?.google?.id) {
    user.oauth = {
      ...user.oauth,
      google: {
        id: profile.id,
        email: profile.emails?.[0]?.value || '',
      },
    };
    await user.save();
  }
}
```

**Behavior**:
1. ‚úÖ **Links the OAuth account** to the existing user
2. ‚úÖ User can log in with **BOTH** email/password AND OAuth
3. ‚úÖ No duplicate account created
4. ‚úÖ OAuth data is added to existing user profile

**Example**:
- User registers with email: `john@gmail.com` + password
- Later tries "Sign in with Google" using `john@gmail.com`
- Result: ‚úÖ Logs in to same account, Google OAuth now linked

---

#### Scenario 2: New User via OAuth
**Lines 74-94 (Google) and 142-161 (Facebook)**

```typescript
else {
  // Create new customer user
  user = await Customer.create({
    email: profile.emails?.[0]?.value,
    userType: 'CUSTOMER',
    profile: {
      name: profile.displayName || 'Google User',
      phone: '', // Will be filled later
      avatar: profile.photos?.[0]?.value,
    },
    oauth: {
      google: {
        id: profile.id,
        email: profile.emails?.[0]?.value || '',
      },
    },
    isActive: true,
    isVerified: true, // Email verified by Google
  });
}
```

**Behavior**:
1. ‚úÖ Creates new CUSTOMER account
2. ‚úÖ Email is **auto-verified** (trusted by Google/Facebook)
3. ‚úÖ No password set (OAuth only)
4. ‚ö†Ô∏è User can later set password if needed

---

### Security Features

1. **Email Matching**: Uses `{ email: profile.emails?.[0]?.value }` to find existing accounts
2. **OAuth ID Linking**: Also checks OAuth provider ID to prevent duplicate linking
3. **Auto-verification**: OAuth users are marked as `isVerified: true`
4. **Profile Data**: Pulls name and avatar from OAuth provider

---

### Edge Cases

#### Case 1: User has email/password, tries OAuth with same email
‚úÖ **Result**: OAuth linked to existing account

#### Case 2: User has Google OAuth, tries Facebook OAuth with same email
‚úÖ **Result**: Both OAuth providers linked to same account

#### Case 3: User has OAuth, tries to register with email/password using same email
‚ùå **Result**: Registration will fail (duplicate email constraint in database)

#### Case 4: User forgot password, uses "Sign in with Google"
‚úÖ **Result**: Logs in successfully, can reset password later if needed

---

### Current Database Status

**All users are using**: `local` authentication (email/password)

**No OAuth users** currently in the database. OAuth is configured but not actively used.

**Supported Providers**:
- ‚úÖ Google OAuth (configured)
- ‚úÖ Facebook OAuth (configured)

**Environment Variables Required**:
- `GOOGLE_CLIENT_ID`
- `GOOGLE_CLIENT_SECRET`
- `FACEBOOK_APP_ID`
- `FACEBOOK_APP_SECRET`

---

## üìù Summary

### Clean Data ‚úÖ
- **7 Retailers**: All have complete profiles with location and GSTIN
- **2 Active Customers**: With location data and order history
- **33 Products**: Well-distributed across categories

### Needs Cleanup ‚ö†Ô∏è
- **6 Test Customers**: No location, no activity (safe to delete)
- **1 Inactive Wholesaler**: No products, no orders (safe to delete)
- **2 Active Wholesalers**: Missing location data (need update)

### OAuth Status üîê
- **Configured**: Google and Facebook OAuth ready
- **Smart Linking**: Automatically links OAuth to existing email accounts
- **No Duplicates**: Cannot create duplicate accounts with same email
- **Currently Unused**: All users use local authentication

---

**Recommendation**: Run the cleanup script to remove test accounts and add location data to active wholesalers.
